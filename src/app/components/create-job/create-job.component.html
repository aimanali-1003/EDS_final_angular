<div class="container" [style.width]="jobData.template ? '100%' : '50%'">
  <div class="job">
    <div class="job-content">
      <h2 class="job-title" style="font-size: 20.667px; font-weight: bold; font-family: 'Quicksand', sans-serif;">
        {{ isViewOnly ? 'View Job' : (isEdit ? 'Edit Job' : 'Create New Job') }}</h2>

      <form class="form-grid">
        <div class="form-row">
          <!-- Job Name -->
          <div class="form-item">
            <mat-form-field class="full-width">
              <input [disabled]="isViewOnly" matInput placeholder="Job Name" [(ngModel)]="jobData.jobName"
                name="jobType" required>
            </mat-form-field>
          </div>

          <!-- Select Template dropdown -->
          <div class="form-item">
            <mat-form-field class="full-width">
              <mat-select [disabled]="isViewOnly" placeholder="Template Name" [(value)]="selectedTemplate" name="TemplateName" required (selectionChange)="onTemplateSelectionChange()">
                <mat-option *ngFor="let template of templates" [value]="template">{{ template.templateName }}</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
        </div>
        
        <div class="form-row">
          <!-- Select client dropdown -->
          <div class="form-item">
            <mat-form-field class="full-width">
              <mat-label>Client Name</mat-label>
              <mat-select [disabled]="isViewOnly" placeholder="Select Client" [(ngModel)]="jobData.client.clientId"
                name="TemplateName" required>
                <mat-option *ngFor="let client of clients" [value]="client.clientId">
                  {{ client.clientName }}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>

          <!-- Select Recipient Type Dropdown -->
          <div class="form-item">
            <mat-form-field class="full-width">
              <mat-label>Data Recipient Type</mat-label>
              <mat-select [disabled]="isViewOnly" name="dataRecipientTypeDropdown" [(value)]="selectedRecipientType">
                <mat-option *ngFor="let type of dataRecipientTypeLookups" [value]="type.id">
                  {{ type.name }}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
        </div>

        <div class="form-row">
          <!-- FileFormat Dropdown -->
          <div class="form-item">
            <mat-form-field class="full-width">
              <mat-label>File Format Type</mat-label>
              <mat-select [disabled]="isViewOnly" name="fileFormatTypeDropdown" [(value)]="selectedFileFormatType">
                <mat-option *ngFor="let type of fileFormatTypeLookups" [value]="type.id">
                  {{ type.name }}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>

          <!-- Frequency Dropdown -->
          <div class="form-item">
            <mat-form-field class="full-width">
              <mat-select [disabled]="isViewOnly" placeholder="Frequency" name="frequency"
                [(value)]="selectedFrequencyTypeLookups" required>
                <mat-option *ngFor="let type of frequencyTypeLookups" [value]="type.name">
                  {{type.name }}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
        </div>

        <!-- Frequency Type Once -->
        <div *ngIf="selectedFrequencyTypeLookups === 'Once'" class="form-row">

          <!-- Start Date Once -->
          <div class="form-item">
            <mat-form-field class="full-width">
              <input matInput type="date" [disabled]="isViewOnly" [(ngModel)]="selectedDate" name="StartDate"
                placeholder="Start Date" required>
            </mat-form-field>
          </div>

          <!-- Start Time Once -->
          <div class="form-item">
            <mat-form-field class="full-width">
              <input matInput type="time" [disabled]="isViewOnly" [(ngModel)]="selectedTime" name="StartTime"
                placeholder="Start Time" required>
            </mat-form-field>
          </div>
          <!-- <button (click)="combineDateTime()">Combine Date and Time</button> -->
        </div>

        <!-- Frequency Type Daily -->
        <div *ngIf="selectedFrequencyTypeLookups === 'Daily'">
          <div class="form-item">
            <mat-form-field class="full-width">
              <input matInput type="time" [disabled]="isViewOnly" [(ngModel)]="selectedTime" name="StartTime"
                placeholder="Start Time" required>
            </mat-form-field>
          </div>
          <!-- <button (click)="setDailyStartTime()">Set Start Time</button> -->
        </div>

        <!-- Frequency Type Weekly -->
        <div *ngIf="selectedFrequencyTypeLookups === 'Weekly'" class="form-row">
          <div class="form-item">
            <mat-form-field class="full-width">
              <mat-select [disabled]="isViewOnly" placeholder="DayofWeek" [(value)]="selectedDayOfWeekTypeLookups"
                name="dayofweeklkp">
                <mat-option *ngFor="let type of dayofWeekLookups" [value]="type.name">
                  {{ type.name }}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>

          <div class="form-item">
            <mat-form-field class="full-width">
              <input matInput type="time" [disabled]="isViewOnly" [(ngModel)]="selectedTime" name="StartTime"
                placeholder="Start Time" required>
            </mat-form-field>
          </div>
        </div>

        <!-- Frequency Type Monthly -->
        <div *ngIf="selectedFrequencyTypeLookups === 'Monthly'" class="form-row">
          <!-- Start Date Monthly -->
          <div class="form-item">
            <mat-form-field class="full-width">
              <input matInput type="date" [disabled]="isViewOnly" [(ngModel)]="selectedDate" name="StartDate"
                placeholder="Start Date" required>
            </mat-form-field>
          </div>

          <!-- Start Time Monthly -->
          <div class="form-item">
            <mat-form-field class="full-width">
              <input matInput type="time" [disabled]="isViewOnly" [(ngModel)]="selectedTime" name="StartTime"
                placeholder="Start Time" required>
            </mat-form-field>
          </div>
        </div>

        <!-- Notification Check -->
        <div class="form-row">
          <mat-form-field class="full-width">
            <mat-select [disabled]="isViewOnly" placeholder="Notification Check" [(ngModel)]="jobData.notificationCheck"
              name="NotificationCheck">
              <mat-option [value]="true">Yes</mat-option>
              <mat-option [value]="false">No</mat-option>
            </mat-select>
          </mat-form-field>
        </div>

        <!-- MinMax record count alaram -->
        <div class="form-row">
          <div class="form-item">
            <mat-form-field class="full-width">
              <input [disabled]="isViewOnly" matInput placeholder="Min Record Count Alarm"
                [(ngModel)]="jobData.minRecordCountAlarm" name="MinRecordCountAlarm">
            </mat-form-field>
          </div>

          <div class="form-item">
            <mat-form-field class="full-width">
              <input [disabled]="isViewOnly" matInput placeholder="Max Record Count Alarm"
                [(ngModel)]="jobData.maxRecordCountAlarm" name="MaxRecordCountAlarm">
            </mat-form-field>
          </div>
        </div>

        <!-- MinMax Run Duration Alarm -->
        <div class="form-row">
          <div class="form-item">
            <mat-form-field class="full-width">
              <input [disabled]="isViewOnly" matInput placeholder="Min Run Duration Alarm"
                [(ngModel)]="jobData.minRunDurationAlarm" name="MinRunDurationAlarm">
            </mat-form-field>
          </div>
          <div class="form-item">
            <mat-form-field class="full-width">
              <input [disabled]="isViewOnly" matInput placeholder="Max Run Duration Alarm"
                [(ngModel)]="jobData.maxRunDurationAlarm" name="MaxRunDurationAlarm">
            </mat-form-field>
          </div>
        </div>

        <div *ngIf="!isViewOnly" class="button-container" style="padding-top: 10px;">
          <button *ngIf="!isEdit" mat-button class="luxury-modal-button-cancel" (click)="goToJobScreen()"> <span
              class="icon">&#10006;</span> Cancel</button>
          <button *ngIf="!isEdit" mat-raised-button class="create-job-button" type="submit"
            (click)="createUpdatejob()"><mat-icon style="margin-right: 8px;">done_all</mat-icon>Create Job</button>
          <button *ngIf="isEdit" mat-button class="luxury-modal-button-cancel" (click)="goToJobScreen()"> <span
              class="icon">&#10006;</span> Cancel</button>
          <button *ngIf="isEdit" mat-raised-button class="create-job-button" (click)="createUpdatejob()">
            <mat-icon style="margin-right: 8px;">done_all</mat-icon> Save Changes
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Template Name and Columns Display-->
  <div class="template-container" >
    <div class="job-content" *ngIf="selectedTemplate">
      <h2 class="job-title" style="font-size: 20.667px; font-weight: bold; font-family: 'Quicksand', sans-serif;">
        Template Details</h2>
      <div class="form-row" style="font-family: 'Quicksand', sans-serif;">
        <p><strong>Category Name:</strong> {{ associatedCategoryName }}</p>
      </div>
      <div class="form-row" style="font-family: 'Quicksand', sans-serif;">
        <p><strong>Columns:</strong></p>
      </div>
      <div class="scrollable-column" *ngIf="associatedColumns && associatedColumns.length">
        <div class="column-checkbox" *ngFor="let column of associatedColumns"
          style="font-family: 'Quicksand', sans-serif;">
          <mat-checkbox [disabled]="true" [checked]="true" [ngClass]="{'checked-checkbox': true}">
            {{ column.columnName }}
          </mat-checkbox>
          <p *ngIf="!associatedColumns || !associatedColumns.length">No columns found.</p>
        </div>
      </div>
    </div>
  </div>
</div>