
<div class="client">
  <div class="client-content">
    <h2 class="client-title" style="font-size: 20.667px; font-weight: bold; font-family: 'Quicksand', sans-serif;">
      {{ isViewOnly ? 'View Client' : (isEdit ? 'Edit Client' : 'Create New Client') }}</h2>

    <form class="form-grid">
      <div class="form-row">
        <mat-form-field class="form-item">
          <input [disabled]="isViewOnly" matInput placeholder="Client Name" [(ngModel)]="clientData.clientName" name="clientName" required>
        </mat-form-field>

        <mat-form-field class="form-item">
          <input [disabled]="isViewOnly" matInput placeholder="Client Code" [(ngModel)]="clientData.clientCode" name="clientCode" required>
        </mat-form-field>
      </div>

      <div class="form-row">

        <mat-form-field class="form-item-dropdown">
          <mat-label>Organization Level</mat-label>
          <mat-select [(ngModel)]="selectedOrganizationLevel" (ngModelChange)="onSelectedOrganizationLevelChange()" name="first" [disabled]="isViewOnly">
            <mat-option *ngFor="let level of organizationLevelsEnum" [value]="level.key">
              {{ level.value }}
            </mat-option>
          </mat-select>
        </mat-form-field>
        
        <mat-form-field class="form-item-dropdown">
          <mat-label>Organization Description</mat-label>
          <mat-select [disabled]="isViewOnly" [(ngModel)]="selectedOrgCode" name="selectedOrganizationDescription" (ngModelChange)="onOrgSelectChange($event)">
            <div class="search-container">
              <input #searchInput type="text" matInput [placeholder]="'Search organization description'" (keyup)="searchOrganizationDescription($event)" [disabled]="isViewOnly">
              <button mat-icon-button (click)="clearSearch(searchInput)">
                <mat-icon>close</mat-icon>
              </button>
            </div>
            <mat-option *ngFor="let level of filteredOrganizationLevels" [value]="level.code">
              {{ level.code }} - {{ level.description }}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <div class="add-icon" (click)="addFormRow()">
          <mat-icon>add_circle</mat-icon>
        </div>
      </div>
    
<div *ngFor="let row of formRows; let i = index" class="form-row">
  <mat-form-field class="form-item-dropdown">
    <mat-label>Organization Level</mat-label>
    <mat-select [(ngModel)]="row.selectedOrgLevel" name="selectedOrgLevel{{i}}" (ngModelChange)="onSelectedOrganizationLevelChanged(row.selectedOrgLevel, i)" [disabled]="isViewOnly">
      <mat-option *ngFor="let level of organizationLevelsEnum" [value]="level.key">
        {{ level.value }}
      </mat-option>
    </mat-select>
  </mat-form-field>

  <mat-form-field class="form-item-dropdown">
    <mat-label>Organization Description</mat-label>
    <mat-select [(ngModel)]="row.selectedSecondDropdownValue" name="selectedSecondDropdownValue{{i}}" [disabled]="isViewOnly">
      <mat-option *ngFor="let level of row.filteredOrganizationLevels" [value]="level">
       {{ level.code }} - {{ level.description }}
      </mat-option>
    </mat-select>
  </mat-form-field>

   <div class="delete-icon" (click)="removeFormRow(i)">
    <mat-icon class="delete-icon-content">remove_circle</mat-icon>
  </div>

  <div class="add-icon" (click)="addFormRow()">
    <mat-icon>add_circle</mat-icon>
  </div>
</div>
      <div *ngIf="isEdit"  class="form-row">
        <mat-slide-toggle [color]="clientData.isActive ? 'primary' : 'warn'" [disabled]="isViewOnly" [(ngModel)]="clientData.isActive" name="active" (change)="toggleActiveStatus()">Active</mat-slide-toggle>
      </div>

      <div *ngIf="!isViewOnly" class="button-container" style="padding-top: 10px;">
        <button *ngIf="!isEdit"  mat-button class="luxury-modal-button-cancel" (click)="goToClientScreen()"> <span class="icon">&#10006;</span> Cancel</button>
        <button *ngIf="!isEdit"  mat-raised-button class="create-client-button" (click)="onCreateClientSubmit()"><mat-icon style="margin-right: 8px;">done_all</mat-icon>Create Client</button>
        <button *ngIf="isEdit"  mat-button class="luxury-modal-button-cancel" (click)="goToClientScreen()">
          <span class="icon">&#10006;</span> Cancel
        </button>
        <button *ngIf="isEdit"  mat-raised-button class="create-client-button" (click)="createUpdateClient()">
          <mat-icon style="margin-right: 8px;">done_all</mat-icon> Save Changes
        </button>
      </div>
    </form>
  </div>
</div>
