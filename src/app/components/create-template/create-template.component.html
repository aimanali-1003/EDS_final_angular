<div class="card-container" style="padding: 40px;">
  <mat-card class="luxury-card">
    <mat-card-header>
      <h2 class="client-title" style="font-size: 20.667px; font-weight: bold; font-family: 'Quicksand', sans-serif;">
        {{ isViewOnly ? 'View Template' : (isEdit ? 'Edit Template' : 'Create New Template') }}
      </h2>
    </mat-card-header>
    <div class="row">

      <!-- Template Name-->
      <mat-form-field class="flexible-field">
        <input matInput [disabled]="isViewOnly" placeholder="Template Name" [(ngModel)]="templateData.templateName">
      </mat-form-field>

      <mat-form-field *ngIf="!isEdit && !isViewOnly">
        <mat-label>Select Category</mat-label>
        <mat-select [(value)]="selectedCategory" (selectionChange)="onCategorySelectionChange()">
          <mat-option *ngFor="let category of categories" [value]="category.categoryId">
            {{ category.categoryName }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field *ngIf="templateData.category && isViewOnly">
        <ng-container >
          <input matInput [disabled]="isViewOnly" placeholder="Category Name" [(ngModel)]="templateData.category.categoryName">
        </ng-container>
      </mat-form-field>
      
      

      <!-- Column Select -->
      <div *ngIf="selectedCategoryColumns.length > 0" class="selected-category-columns">
        <h3>Selected Category Columns:</h3>
        <ul>
          <li *ngFor="let column of selectedCategoryColumns">
            <mat-checkbox [(ngModel)]="column.isActive" (change)="onCheckboxChange(column)">
              {{ column.columnName }}
            </mat-checkbox>
          </li>
        </ul>
      </div>
      <div *ngIf="selectedCategoryColumns.length === 0" class="no-columns-message">
        No Columns
      </div>
    </div>

    <mat-card-actions *ngIf="!isViewOnly" class="button-container">
      <button *ngIf="!isEdit" mat-button class="luxury-modal-button-cancel" (click)="goToTemplateScreen()"> <span
          class="icon">&#10006;</span> Cancel</button>
      <button *ngIf="!isEdit" mat-raised-button class="create-job-button" (click)="createUpdateTemplate()"><mat-icon
          style="margin-right: 8px;">done_all</mat-icon>Create Template</button>
      <button *ngIf="isEdit" mat-button class="luxury-modal-button-cancel" (click)="goToTemplateScreen()">
        <span class="icon">&#10006;</span> Cancel
      </button>
      <button *ngIf="isEdit" mat-raised-button class="create-job-button" (click)="createUpdateTemplate()">
        <mat-icon style="margin-right: 8px;">done_all</mat-icon> Save Changes
      </button>
    </mat-card-actions>
  </mat-card>

  <mat-card class="luxury-card" *ngIf="!isEdit">
    <h3 style="font-size: 17px; font-weight: bold; font-family: 'Quicksand', sans-serif;">Columns Order</h3>
    <h3 *ngIf="!isViewOnly" style="font-size: 14px; font-weight: bold; font-family: 'Quicksand', sans-serif;">
      Please drag the columns to reorder the template structure.
    </h3>
    <div cdkDropList class="example-list" (cdkDropListDropped)="drop($event)">
      <div class="example-box" *ngFor="let column of getCheckedColumnsForDragDrop(); let i = index" cdkDrag
        [cdkDragDisabled]="isViewOnly">
        {{ i + 1 }}. {{ column.columnName }}
        <button *ngIf="!isViewOnly" (click)="deleteColumn(column.columnName)" class="btn btn-sm btn-danger">X</button>
      </div>
    </div>
  </mat-card>


  <mat-card class="luxury-card" *ngIf="isViewOnly">
    <h3 style="font-size: 17px; font-weight: bold; font-family: 'Quicksand', sans-serif;">Columns Order</h3>
    <div cdkDropList class="example-list" (cdkDropListDropped)="drop($event)">
      <div class="example-box" *ngFor="let column of select; let i = index" cdkDrag
        [cdkDragDisabled]="isViewOnly">
        {{ i + 1 }}. {{ column }}
        <button [disabled]="isViewOnly" (click)="deleteColumn(column.columnName)" class="btn btn-sm btn-danger">X</button>
      </div>
    </div>
  </mat-card>
  
  
</div>